<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.68.3"><meta name=description content="Documentation for Hugo Learn Theme"><link rel=icon href=/farmer/images/favicon.png type=image/png><title>Deployment Guidance :: Farmer</title><link href=/farmer/css/nucleus.css?1586115901 rel=stylesheet><link href=/farmer/css/fontawesome-all.min.css?1586115901 rel=stylesheet><link href=/farmer/css/hybrid.css?1586115901 rel=stylesheet><link href=/farmer/css/featherlight.min.css?1586115901 rel=stylesheet><link href=/farmer/css/perfect-scrollbar.min.css?1586115901 rel=stylesheet><link href=/farmer/css/auto-complete.css?1586115901 rel=stylesheet><link href=/farmer/css/atom-one-dark-reasonable.css?1586115901 rel=stylesheet><link href=/farmer/css/theme.css?1586115901 rel=stylesheet><link href=/farmer/css/hugo-theme.css?1586115901 rel=stylesheet><link href=/farmer/css/theme-green.css?1586115901 rel=stylesheet><script src=/farmer/js/jquery-3.3.1.min.js?1586115901></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-72817248-3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-72817248-3');</script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/farmer/deployment-guidance/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://compositionalit.github.io/farmer/><svg id="grav-logo" style="width:100%;height:100%" viewBox="0 0 504 140" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421"><path d="M235.832 71.564l-7.98-.001c-1.213.001-2.197.987-2.197 2.204v15.327l-.158.132c-4.696 3.962-10.634 6.14-16.719 6.14-14.356.0-26.034-11.68-26.034-26.037.0-14.358 11.678-26.035 26.034-26.035 5.582.0 10.919 1.767 15.437 5.113.877.649 2.093.56 2.866-.211l5.69-5.69c.444-.442.675-1.055.639-1.681-.034-.627-.336-1.206-.828-1.597-6.76-5.363-15.214-8.314-23.805-8.314-21.18.0-38.414 17.233-38.414 38.415.0 21.183 17.234 38.415 38.414 38.415 10.937.0 21.397-4.705 28.698-12.914.358-.403.556-.921.556-1.46v-19.603c0-1.217-.985-2.203-2.2-2.203" style="fill:#000;fill-rule:nonzero"/><path d="M502.794 34.445c-.408-.616-1.1-.989-1.838-.989h-8.684c-.879.0-1.673.522-2.022 1.329l-24.483 56.839-24.92-56.852c-.352-.799-1.142-1.316-2.012-1.316h-8.713c-.744.0-1.44.373-1.843.995-.408.623-.476 1.408-.174 2.09l30.186 68.858c.352.799 1.143 1.317 2.017 1.317h10.992c.879.0 1.673-.527 2.021-1.329l29.655-68.861c.289-.68.222-1.461-.182-2.081" style="fill:#000;fill-rule:nonzero"/><path d="M388.683 34.772c-.353-.798-1.142-1.316-2.017-1.316h-10.988c-.879.0-1.673.522-2.021 1.329l-29.655 68.861c-.294.675-.226 1.46.182 2.077.407.619 1.096.993 1.838.993h8.684c.879.0 1.673-.526 2.022-1.329l24.478-56.842 24.92 56.854c.353.798 1.143 1.317 2.013 1.317h8.717c.744.0 1.44-.374 1.843-.993.408-.624.471-1.41.174-2.094l-30.19-68.857z" style="fill:#000;fill-rule:nonzero"/><path d="M309.196 81.525l.476-.229c8.675-4.191 14.279-13.087 14.279-22.667.0-13.881-11.295-25.174-25.176-25.174h-31.863c-1.214.0-2.199.988-2.199 2.202v68.855c0 1.219.985 2.204 2.199 2.204h7.979c1.214.0 2.2-.985 2.2-2.204V45.833h21.684c7.059.0 12.799 5.739 12.799 12.796.0 5.885-3.996 10.989-9.728 12.408-1.032.261-2.064.393-3.071.393h-7.977c-.829.0-1.585.467-1.959 1.205-.378.74-.305 1.625.187 2.296l22.62 30.884c.412.566 1.07.901 1.771.901h9.915c.827.0 1.587-.467 1.96-1.207.378-.742.302-1.629-.186-2.296l-15.91-21.688z" style="fill:#000;fill-rule:nonzero"/><path d="M107.191 80.969c-7.255-4.794-11.4-8.845-15.011-16.109-2.47 4.977-8.236 12.376-17.962 18.198-4.856 15.106-27.954 44.015-35.43 39.916-2.213-1.212-2.633-2.808-2.133-4.456.536-4.129 9.078-13.62 9.078-13.62s.18 1.992 2.913 6.187c-3.609-11.205 5.965-25.031 8.5-29.738 3.985-1.269 4.274-6.387 4.274-6.387.255-7.909-3.278-13.635-6.701-17.059 2.459 3.002 3.255 7.539 3.372 11.694v.023c.012.469.012.93.011 1.39-.117 3.439-1.157 8.19-3.383 8.19l.006.03c-2.289-.098-5.115.391-7.639 1.18l-5.582 1.334s2.977-.136 4.584 1.252c-1.79 2.915-5.769 6.533-10.206 8.588-6.457 2.995-8.312-2.964-5.034-6.838.805-.946 1.618-1.745 2.387-2.399-.495-.513-.807-1.198-.889-2.068-.001-.005-.004-.009-.005-.013-.45-1.977-.202-4.543 2.596-8.623.551-.863 1.214-1.748 2.007-2.647.025-.031.046-.059.072-.089.034-.042.072-.08.108-.121.02-.023.039-.045.059-.068.2-.228.413-.45.639-.663 3.334-3.414 8.599-6.966 16.897-10.152 9.675-14.223 13.219-16.89 13.219-16.89 1.071-1.096 2.943-2.458 3.632-2.805-5.053-8.781-6.074-21.158-4.75-24.493-.107.18-.206.365-.287.556.49-1.143.819-1.509 1.328-2.111 1.381-1.632 6.058-2.488 7.737.971.895 1.844 1.063 4.232 1.034 6.023-3.704-.193-7.063 4.036-7.063 4.036s3.067-1.448 6.879-1.473c0 0 1.015.883 2.283 2.542-1.712 3.213-4.524 10.021-2.488 17.168.338 1.408.849 2.619 1.483 3.648.024.045.044.089.069.135.051.066.096.122.144.183 3.368 5.072 9.542 5.665 9.542 5.665-2.906-1.45-5.274-3.76-6.816-6.56-.8-1.498-1.291-2.762-1.592-3.761-1.636-6.313.771-9.999 2.149-12.471 3.17-4.917 8.944-7.893 15.151-7.185 8.712.995 14.968 8.862 13.973 17.571-.608 5.321-3.781 9.723-8.142 12.117 1.049 2.839-.073 6.28-.073 6.28 2.642 3.323 2.758 5.238 2.667 7.017-3.357-.565-6.618 1.701-6.618 1.701s6.476-1.546 10.238 1.81c2.446 2.631 4.078 5.009 5.051 6.766 1.393 2.505 7.859 2.683 7.123 7.188-.737 4.499-5.669 4.542-13.401-.56M69.571.0C31.147.0.0 31.148.0 69.567c0 38.422 31.147 69.573 69.571 69.573 38.42.0 69.568-31.151 69.568-69.573.0-38.42-31.148-69.567-69.568-69.567" style="fill:#000;fill-rule:nonzero"/><path d="M73.796 51.693c.813-.814.813-2.134.0-2.947-.815-.814-2.133-.814-2.947.0-.815.813-.815 2.133.0 2.947.814.813 2.132.813 2.947.0" style="fill:#000;fill-rule:nonzero"/><path d="M66.445 53.149c-.814.813-.814 2.133.0 2.947.813.814 2.133.814 2.947.0.813-.814.813-2.134.0-2.947-.814-.813-2.134-.813-2.947.0" style="fill:#000;fill-rule:nonzero"/><path d="M79.231 54.233c-1.274-1.274-3.339-1.272-4.611.0l-2.713 2.712c-1.274 1.275-1.274 3.339.0 4.612l2.978 2.978c1.274 1.275 3.338 1.274 4.611.0l2.712-2.712c1.274-1.274 1.274-3.339.0-4.612l-2.977-2.978z" style="fill:#000;fill-rule:nonzero"/><path d="M95.759 41.445c-2.151-2.578 1.869-7.257 4.391-4.463 4.645 5.148-2.237 7.041-4.391 4.463M105.004 44.132c3.442-6.553-1.427-10.381-4.773-13.523-5.36-5.039-10.706-7.217-16.811-.241-6.102 6.977-2.226 15.068 3.356 19.061 5.584 3.994 14.782 1.255 18.228-5.297" style="fill:#000;fill-rule:nonzero"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/farmer/js/lunr.min.js?1586115901></script><script type=text/javascript src=/farmer/js/auto-complete.js?1586115901></script><script type=text/javascript>var baseurl="https:\/\/compositionalit.github.io\/farmer\/";</script><script type=text/javascript src=/farmer/js/search.js?1586115901></script></div><div class=highlightable><ul class=topics><li data-nav-id=/farmer/about/ title=About class=dd-item><a href=/farmer/about/>About</a></li><li data-nav-id=/farmer/quickstarts/ title=Quickstarts class=dd-item><a href=/farmer/quickstarts/>Quickstarts</a><ul><li data-nav-id=/farmer/quickstarts/quickstart-1/ title="Your first Farmer template" class=dd-item><a href=/farmer/quickstarts/quickstart-1/>Your first Farmer template</a></li><li data-nav-id=/farmer/quickstarts/quickstart-2/ title="Working with multiple resources" class=dd-item><a href=/farmer/quickstarts/quickstart-2/>Working with multiple resources</a></li><li data-nav-id=/farmer/quickstarts/quickstart-3/ title="Deploying to Azure" class=dd-item><a href=/farmer/quickstarts/quickstart-3/>Deploying to Azure</a></li><li data-nav-id=/farmer/quickstarts/template/ title="The Farmer .NET Template" class=dd-item><a href=/farmer/quickstarts/template/>The Farmer .NET Template</a></li></ul></li><li data-nav-id=/farmer/api-overview/ title="API Overview" class=dd-item><a href=/farmer/api-overview/>API Overview</a><ul><li data-nav-id=/farmer/api-overview/writer/ title="Generating templates" class=dd-item><a href=/farmer/api-overview/writer/>Generating templates</a></li><li data-nav-id=/farmer/api-overview/resources/ title=Resources class=dd-item><a href=/farmer/api-overview/resources/>Resources</a><ul><li data-nav-id=/farmer/api-overview/resources/storage-account/ title="Storage Account" class=dd-item><a href=/farmer/api-overview/resources/storage-account/>Storage Account</a></li><li data-nav-id=/farmer/api-overview/resources/web-app/ title="Web App" class=dd-item><a href=/farmer/api-overview/resources/web-app/>Web App</a></li><li data-nav-id=/farmer/api-overview/resources/app-insights/ title="App Insights" class=dd-item><a href=/farmer/api-overview/resources/app-insights/>App Insights</a></li><li data-nav-id=/farmer/api-overview/resources/functions/ title=Functions class=dd-item><a href=/farmer/api-overview/resources/functions/>Functions</a></li><li data-nav-id=/farmer/api-overview/resources/cosmosdb/ title="Cosmos DB" class=dd-item><a href=/farmer/api-overview/resources/cosmosdb/>Cosmos DB</a></li><li data-nav-id=/farmer/api-overview/resources/sql/ title="SQL Azure" class=dd-item><a href=/farmer/api-overview/resources/sql/>SQL Azure</a></li><li data-nav-id=/farmer/api-overview/resources/search/ title=Search class=dd-item><a href=/farmer/api-overview/resources/search/>Search</a></li><li data-nav-id=/farmer/api-overview/resources/virtual-machine/ title="Virtual Machine" class=dd-item><a href=/farmer/api-overview/resources/virtual-machine/>Virtual Machine</a></li><li data-nav-id=/farmer/api-overview/resources/keyvault/ title="Key Vault" class=dd-item><a href=/farmer/api-overview/resources/keyvault/>Key Vault</a></li><li data-nav-id=/farmer/api-overview/resources/eventhub/ title="Event Hub" class=dd-item><a href=/farmer/api-overview/resources/eventhub/>Event Hub</a></li><li data-nav-id=/farmer/api-overview/resources/redis/ title="Redis Cache" class=dd-item><a href=/farmer/api-overview/resources/redis/>Redis Cache</a></li><li data-nav-id=/farmer/api-overview/resources/arm/ title="ARM Deployment" class=dd-item><a href=/farmer/api-overview/resources/arm/>ARM Deployment</a></li></ul></li><li data-nav-id=/farmer/api-overview/parameters/ title="Parameters and Variables" class=dd-item><a href=/farmer/api-overview/parameters/>Parameters and Variables</a></li><li data-nav-id=/farmer/api-overview/expressions/ title="ARM Expressions" class=dd-item><a href=/farmer/api-overview/expressions/>ARM Expressions</a></li></ul></li><li data-nav-id=/farmer/deployment-guidance/ title="Deployment Guidance" class="dd-item
parent
active"><a href=/farmer/deployment-guidance/>Deployment Guidance</a></li><li data-nav-id=/farmer/faq/ title=FAQs class=dd-item><a href=/farmer/faq/>FAQs</a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/compositionalit/farmer><i class="fab fa-fw fa-github"></i>GitHub repo</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/CompositionalIT/farmer/tree/docs/content/deployment-guidance/_index.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/farmer/>Farmer</a> > Deployment Guidance</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Deployment Guidance</h1><p>You can deploy Farmer templates in a number of ways, depending on how you would prefer to work with ARM templates and tooling.</p><h4 id=arm-templates-are-just-a-means-to-an-end-to-me>ARM templates are just a means to an end to me</h4><p>If you don&rsquo;t use ARM templates today, or don&rsquo;t need to edit them directly, you can opt to do away with them completely. You&rsquo;ll create Farmer applications which use a simple F# SDK to interact with Azure; Farmer will create ARM templates in the background for you transparently, so you&rsquo;ll never see or interact with them.</p><p>In such a case, you can opt to deploy them using one of two modes:</p><ul><li>An <a href=../api-overview/writer/#interactive-deploy-to-azure>interactive mode</a>, perfect for when testing out templates from your development environment. This mode provides an F# wrapper around the Azure CLI which captures your credentials during the deployment process.</li><li>An <a href=../api-overview/writer/#non-interactive-deploy-to-azure>automated mode</a>, in which you create a <em>service principal</em> in Azure (effectively, an account in Azure Active Directory that has permissions to create and amend resources without human intervention), and securely use the credentials of this account to deploy the ARM template.</li></ul><p>If you&rsquo;re looking to stay within F# and e.g. respond to outcomes from the deployment such as using deployment outputs, this is an excellent option because Farmer is just a dotnet application and the deployment call is a simple function call.</p><p>Another benefit of this is because Farmer is a simple .NET Standard library, you can use it natively within .NET build tools such as FAKE or CAKE.</p><h5 id=combined-resource-and-application-deployment>Combined Resource and Application Deployment</h5><p>Farmer can also optionally do more for you by handling the entire deployment process, including <strong>deployment of your application artifacts</strong>.</p><div class=mermaid align=left>graph LR
subgraph Azure Resource Group
D(Azure App Service)
end
subgraph JSON
C(ARM Template) -- REST API or Azure CLI --> D
end
subgraph .NET
A(Farmer)-- resources emitted to --> C
A -. your application deployed via ZIP Deploy.-> D
end</div><p>Watch this short video to see more!</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/5nRZwxMQUFE style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h4 id=i-already-have-an-arm-deployment-strategy>I already have an ARM deployment strategy</h4><p>If you already use ARM templates, you&rsquo;ll probably already have a strategy for working with templates and deploying them to Azure, such as <a href=https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/deploy-powershell>PowerShell</a>, the <a href=https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/deploy-cli>Azure CLI</a> or a build system such as <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/deploy/azure-resource-group-deployment?view=azure-devops">Azure DevOps</a> or <a href=https://octopus.com/docs/deployment-examples/azure-deployments/resource-groups>Octopus Deploy</a>. In such a case, you may want to use Farmer to <em>generate</em>, but not <em>deploy</em>, your ARM templates.</p><h4 id=i-want-to-hard-craft-my-arm-templates>I want to hard-craft my ARM templates</h4><p>If you want to retain fine-grained control over ARM templates, you can use Farmer to create a one-off task to rapidly generate an ARM template which you then take ownership of. In this case, Farmer itself won&rsquo;t be a part of your build / deploy chain, which will remain the same as today - you&rsquo;ll use Farmer just as an edit-time task to create the ARM template itself.</p><p>The choice is yours.</p><h4 id=how-do-i-create-a-service-principal>How do I create a Service Principal?</h4><p>If you&rsquo;re trying to deploy to Azure in an automated fashion, you&rsquo;ll need to create a Service Principal account that has permissions in Azure to deploy ARM templates on your behalf.</p><p>The Azure CLI provides a simple way to create one using the <a href="https://docs.microsoft.com/en-us/cli/azure/ad/sp?view=azure-cli-latest#az-ad-sp-create-for-rbac">az ad sp</a> command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd>az ad sp create-for-rbac --name farmer-deploy
</code></pre></div><p>This will provide output similar to the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd>{
  <span style=color:#e6db74>&#34;appId&#34;</span>: <span style=color:#e6db74>&#34;1181c21b-78f3-42b3-a26d-03ba75c7b674&#34;</span>,
  <span style=color:#e6db74>&#34;displayName&#34;</span>: <span style=color:#e6db74>&#34;farmer-deploy&#34;</span>,
  <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;http://farmer-deploy&#34;</span>,
  <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;4aa3b120-f2b2-4ea9-941b-5891fef0ef11&#34;</span>,
  <span style=color:#e6db74>&#34;tenant&#34;</span>: <span style=color:#e6db74>&#34;aa7f7453-15af-4ab0-5d41-aeb4a25293bc&#34;</span>
}
</code></pre></div><p>The mapping from these fields to the credentials used in Farmer are:</p><table><thead><tr><th>Azure CLI</th><th>Farmer</th></tr></thead><tbody><tr><td>appId</td><td>ClientId</td></tr><tr><td>password</td><td>ClientSecret</td></tr><tr><td>tenant</td><td>TenantId</td></tr></tbody></table><p>You should store these credentials in a secure store, such as your CI/CD service or e.g. Azure KeyVault and should avoid committing them into source control.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/farmer/api-overview/expressions/ title="ARM Expressions"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/farmer/faq/ title=FAQs style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/farmer/js/clipboard.min.js?1586115901></script><script src=/farmer/js/perfect-scrollbar.min.js?1586115901></script><script src=/farmer/js/perfect-scrollbar.jquery.min.js?1586115901></script><script src=/farmer/js/jquery.sticky.js?1586115901></script><script src=/farmer/js/featherlight.min.js?1586115901></script><script src=/farmer/js/highlight.pack.js?1586115901></script><script>hljs.initHighlightingOnLoad();</script><script src=/farmer/js/modernizr.custom-3.6.0.js?1586115901></script><script src=/farmer/js/learn.js?1586115901></script><script src=/farmer/js/hugo-learn.js?1586115901></script><link href=/farmer/mermaid/mermaid.css?1586115901 rel=stylesheet><script src=/farmer/mermaid/mermaid.js?1586115901></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>